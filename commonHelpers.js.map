{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport default function fetchingGallery() {\n  let nextPageNumber = 1;\n  const hitsPerPage = 15;\n\n  async function fetchingGalleryPage(userRequest) {\n    const searchParams = new URLSearchParams({\n      key: '45523690-8d1bfda1291a3399214d9e199',\n      q: userRequest,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page: nextPageNumber,\n      per_page: hitsPerPage,\n    });\n\n    const response = await axios.get(\n      `https://pixabay.com/api/?${searchParams}`\n    );\n\n    nextPageNumber++;\n\n    const { hits, totalHits } = response.data;\n\n    const pageLimit = Math.ceil(totalHits / hitsPerPage);\n    const isLastPage = nextPageNumber > pageLimit;\n\n    return { hits, isLastPage };\n  }\n\n  function resetNextPageNum() {\n    nextPageNumber = 1;\n  }\n\n  return { fetchingGalleryPage, resetNextPageNum };\n}\n","export default function renderGallery(requestedHits, galleryNode) {\n  let markup = '';\n\n  requestedHits.forEach(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      markup += `<li class=\"gallery-item\">\n    <a class=\"gallery-item__link\" href=\"${largeImageURL}\">\n    <img\n    src=\"${webformatURL}\"\n    alt=\"${tags}\"\n    /></a>\n    <ul class=\"image-descr\">\n    <li>\n      <span>Likes</span>\n      <span>${likes}</span>\n    </li>\n    <li>\n      <span>Views</span>\n      <span>${views}</span>\n    </li>\n    <li>\n      <span>Comments</span>\n      <span>${comments}</span>\n    </li>\n    <li>\n      <span>Downloads</span>\n      <span>${downloads}</span>\n    </li>\n  </ul>\n  </li>`;\n    }\n  );\n\n  galleryNode.insertAdjacentHTML('beforeend', markup);\n}\n","// Описаний у документації\nimport iziToast from 'izitoast';\n// Додатковий імпорт стилів\nimport 'izitoast/dist/css/iziToast.min.css';\n// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport fetchingGallery from './js/pixabay-api';\nimport renderGallery from './js/render-functions';\n\nconst searchForm = document.querySelector('.search-form');\nconst galleryList = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('button[data-load]');\n\nconst { fetchingGalleryPage, resetNextPageNum } = fetchingGallery();\nlet userRequest = '';\n\nconst galleryLightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nsearchForm.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  userRequest = event.target.elements.requestValue.value.trim();\n\n  if (!userRequest) {\n    return;\n  }\n\n  resetNextPageNum();\n  clearGallery();\n  showLoader(searchForm);\n  hideLoadMoreBtn();\n\n  try {\n    const { hits: firstPage, isLastPage } = await fetchingGalleryPage(\n      userRequest\n    );\n\n    if (!firstPage.length) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n\n      removeLoader();\n\n      return;\n    }\n\n    renderGallery(firstPage, galleryList);\n    galleryLightbox.refresh();\n\n    removeLoader();\n    showLoadMoreBtn(isLastPage);\n  } catch (error) {\n    console.error(error);\n\n    iziToast.error({\n      message: 'Ooops! Something went wrong. Try again later',\n      position: 'topRight',\n    });\n\n    removeLoader();\n  }\n\n  searchForm.reset();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  showLoader(galleryList);\n  hideLoadMoreBtn();\n\n  const { height: itemHeight } = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect();\n\n  try {\n    const { hits: nextPage, isLastPage } = await fetchingGalleryPage(\n      userRequest\n    );\n\n    removeLoader();\n\n    renderGallery(nextPage, galleryList);\n    galleryLightbox.refresh();\n\n    window.scrollBy(0, itemHeight * 2);\n    showLoadMoreBtn(isLastPage);\n  } catch (error) {\n    console.error(error);\n\n    iziToast.error({\n      message: 'Ooops! Something went wrong. Try again later',\n      position: 'topRight',\n    });\n\n    removeLoader();\n  }\n});\n\nfunction showLoader(leftNeighborNode) {\n  leftNeighborNode.insertAdjacentHTML(\n    'afterend',\n    `<span class='loader'></span>`\n  );\n}\n\nfunction removeLoader(loaderNode = document.querySelector('.loader')) {\n  if (loaderNode) {\n    loaderNode.remove();\n  }\n}\n\nfunction showLoadMoreBtn(isLastPage) {\n  if (loadMoreBtn.classList.contains('visually-hidden')) {\n    if (isLastPage) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      loadMoreBtn.classList.remove('visually-hidden');\n    }\n  }\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.classList.add('visually-hidden');\n}\n\nfunction clearGallery() {\n  galleryList.innerHTML = '';\n}\n"],"names":["fetchingGallery","nextPageNumber","hitsPerPage","fetchingGalleryPage","userRequest","searchParams","response","axios","hits","totalHits","pageLimit","isLastPage","resetNextPageNum","renderGallery","requestedHits","galleryNode","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","galleryList","loadMoreBtn","galleryLightbox","SimpleLightbox","event","clearGallery","showLoader","hideLoadMoreBtn","firstPage","iziToast","removeLoader","showLoadMoreBtn","error","itemHeight","nextPage","leftNeighborNode","loaderNode"],"mappings":"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"}